import BloomFilter

# Create a bloom filter of size 1000
# for holding 100 items
bloom_filter = BloomFilter.BloomFilter(1000, 100)
blockedip= "2021-05-11 16:22:09,178.33.222.243,50855\
2021-05-10 10:46:35,185.222.57.171,3678\
2021-05-10 02:29:59,185.157.161.20,8990\
2021-05-06 02:49:12,194.5.98.120,1515\
2021-05-05 15:08:51,3.142.167.4,18318\
2021-05-04 16:29:09,79.137.109.121,50855\
2021-05-04 07:41:51,46.243.221.40,2703\
2021-05-03 00:21:18,185.140.53.137,5000\
2021-05-02 18:52:50,201.219.204.73,1884\
2021-05-02 10:53:46,185.163.47.163,10134\
2021-04-30 14:34:53,194.5.98.107,6970\
2021-04-30 07:30:43,193.142.146.202,8808\
2021-04-30 06:35:12,79.134.225.10,50\
2021-04-30 00:04:23,84.38.182.88,443\
2021-04-29 13:09:14,5.2.65.197,443\
2021-04-28 22:35:57,34.92.115.71,443\
2021-04-28 09:13:01,136.244.96.52,1234\
2021-04-28 05:22:54,188.34.142.201,443\
2021-04-26 17:15:27,193.38.55.11,443\
2021-04-26 09:06:23,107.155.164.5,4898\
2021-04-25 19:30:15,34.105.210.195,443\
2021-04-23 02:59:52,176.103.59.173,443\
2021-04-22 14:41:31,94.158.245.132,443\
2021-04-22 13:25:44,167.99.184.82,443\
2021-04-22 13:11:27,193.239.84.240,443\
2021-04-22 13:11:27,193.239.84.194,443\
2021-04-22 07:00:01,185.183.162.147,443\
2021-04-22 06:16:06,179.43.166.32,10090\
2021-04-21 17:23:56,94.176.235.200,8808\
2021-04-21 06:54:54,185.102.136.27,443\
2021-04-20 04:55:55,34.96.156.66,443\
2021-04-19 21:10:48,107.175.101.209,7865\
2021-04-19 10:28:38,159.75.110.125,9102\
2021-04-18 19:00:01,94.140.114.21,443\
2021-04-18 15:32:07,82.118.22.118,443\
2021-04-18 13:24:25,194.127.178.197,7707\
2021-04-18 09:02:27,80.92.206.44,443\
2021-04-18 05:39:58,112.74.182.201,443\
2021-04-18 03:15:41,74.119.195.101,443\
2021-04-18 00:48:03,185.163.47.244,443\
2021-04-17 11:07:58,91.228.218.43,443\
2021-04-16 23:11:36,202.168.154.11,443\
2021-04-16 21:43:29,185.212.131.90,443\
2021-04-16 17:33:41,141.136.0.105,443\
2021-04-16 16:56:11,195.54.33.143,443\
2021-04-16 15:42:32,46.29.167.123,443\
2021-04-16 13:30:45,185.163.47.254,443\
2021-04-16 03:01:53,8.140.186.40,8888\
2021-04-15 21:32:22,116.203.178.81,443\
2021-04-15 20:15:25,195.54.33.200,443\
2021-04-15 13:05:33,79.134.225.62,4170\
2021-04-15 12:23:12,66.248.206.71,443\
2021-04-15 05:52:28,185.234.247.219,443\
2021-04-13 21:18:19,141.136.0.96,443\
2021-04-13 16:03:00,204.48.28.130,6606\
2021-04-13 07:04:48,160.124.49.133,443\
2021-04-13 06:46:10,185.141.26.139,443\
2021-04-13 04:55:51,213.152.187.210,42012\
2021-04-12 19:12:04,79.134.225.70,50855\
2021-04-12 15:01:11,74.119.195.166,443\
2021-04-12 13:53:25,5.181.156.75,443\
2021-04-12 13:16:08,74.119.195.168,443\
2021-04-12 07:21:38,176.103.61.84,443\
2021-04-12 04:27:53,195.123.215.115,443\
2021-04-12 03:16:25,194.127.179.127,6666\
2021-04-12 02:28:54,195.54.33.131,443\
2021-04-05 19:05:19,138.197.176.134,443\
2021-04-01 07:42:56,45.144.225.107,43360\
2021-03-25 20:48:20,124.70.89.118,443\
2021-03-24 13:47:38,179.43.140.164,8808\
2021-03-20 01:56:52,198.23.212.148,8808\
2021-03-17 12:29:05,103.224.241.225,1604\
2021-03-16 06:17:25,194.5.97.128,11011\
2021-03-11 23:29:43,18.224.135.48,1612\
2021-01-24 23:40:18,149.56.80.31,443\
2020-12-31 13:33:59,185.157.162.75,443\
2020-10-25 22:00:59,5.181.156.126,443\
2020-03-19 18:55:53,94.158.245.225,443\
2019-12-02 04:50:26,91.224.22.60,443"

count = 0
blocked_ip_list = []
for x in blockedip.split(","):
	count = count +1
	if count%2 == 0:
		blocked_ip_list.append(x)
		

# add 78 all the blocked ip into bloomfilter
print(" ====================                List of worlds top 78 malicious IP's                ===================================")
for item in blocked_ip_list:
	print(item)
	bloom_filter.add_to_filter(item)

print(" ====================                List of all valid IP address in my local subnet              ===================================")
genuine_ip_list = []
for i in range(1, 101):
	print("10.0.0." + str(i))
	genuine_ip_list.append("10.0.0." + str(i))


# check if any of the genuine ip address is identified as malicious
count = 0
for item in genuine_ip_list:
	if not bloom_filter.check_is_not_in_filter(item):
		count = count+1
		print("Genuine Ip address blocked by Filter = > " + item)


# results
if count == 0:
	print(" False positive results => " + str(0) + "%")
else:
	print(" False positive results => " + str(count/100) * 100 + "%")


 




